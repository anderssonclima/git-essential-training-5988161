this is the version 2 code
